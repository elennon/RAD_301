@{
    ViewBag.Title = "ApiIndex";
}




@section scripts
{
    <script>
        

        $(function () {
            //$("#showLegs").hide();
            TripsTable();
        });

        var uri = 'api/ApiIndex';

        function TripsTable() {
            
            $.getJSON(uri)
                .done(function (data) {
                    $('#trips').empty();
                    $("<tr><th><p>Trip Name</p></th><th><p>Start </p></th><th><p>Finish </p></th><th><p>Start Date </p></th><th><p>Finish Date </p></th><th><p> </p></th></tr>").appendTo("#trips");
                    $.each(data, function (key, item) {
                        $("<tr><td>" + item.TripName + "</td><td>" + item.StartLocation + "</td><td>" + item.FinishLocation
                            + "</td><td>" + item.StartDate + "</td><td>" + item.FinishDate + "</td>"
                            + "<td><input type='button' class='btn btn-success active' value='Add Leg' onclick='addLeg(" + item.TripId +")' />"
                            //+ "<input type='button' class='btn btn-info active' value='View All Details' onclick='viewTrip(" + item.TripId + ")' /></td></tr>"
                            + "<a class='btn btn-info active' href='/Home/EditTrip?id=" + item.TripId + "'>View All Details</a></td></tr>"
                            ).appendTo("#trips");
    
                    });
                });
        }

        function createTrip() {
            $.ajax({
                type: 'POST',
                url: '/Home/_Create',
                cache: false,
                contentType: 'application/json; charset=utf-8',
                //data: JSON.stringify(lgs),
                success: function (data) {
                    $("#addTrip").html(data);
                },
                error: function () {
                    alert("we are 138");
                }
            });
        }
        function addLeg(id) {
  
            $.ajax({
                type: 'POST',
                url: '/Home/_AddLeg/' + id,
                cache: false,
                contentType: 'application/json; charset=utf-8',
                //data: JSON.stringify(tripID),
                success: function (data) {
                    $("#addTrip").html(data);
                },
                error: function () {
                    alert("we are 138");
                }
            });
        }
        //function viewTrip(id) {
        //    $.ajax({
        //        type: 'GET',
        //        url: '/Home/EditTrip/' + id,
        //        cache: false,
        //        contentType: 'application/json; charset=utf-8',
        //        //data: JSON.stringify(tripID),
        //        //success: function (data) {
        //        //    $("#viewTripContainer").html(data);
        //        //},
        //        //error: function () {
        //        //    alert("we are 138");
        //        //}
        //    });
        //}      
    </script>

}

        <div  class="form-group" >
            <div class="col-sm-4" id="addTrip" style="float:right">
               @* @Html.Partial("_Create")*@
            </div>
        </div>

<div class="row">
    <div class="col-sm-7">
        <h2>All tours</h2>
        
        <input type="button" class="btn btn-success active" value="Create Trip" onclick="createTrip()" />

        <table id="trips" class="table table-striped table-condensed" style="margin-top: 10px">
        </table>
    </div>
</div>



