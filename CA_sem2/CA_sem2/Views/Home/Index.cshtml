@model IEnumerable<CA_sem2.Models.Trip>

@{
    ViewBag.Title = "Index";
}


@section scripts {
        <script type="text/javascript">
            $(function () {
                $("#datepicker").datepicker({
                    showOn: "button",
                    buttonImage: "~/Images/CALENDAR_gif.jpg",
                    buttonImageOnly: true
                });

                function checkIfFirst() {
                    alert("forty four");
                }
            });

            function detsForThisTrip(id) {

                var trip = {
                    TripId: id
                };
                $.ajax({
                    type: 'POST',
                    url: '/Home/EditTrip',
                    cache: false,
                    contentType: 'application/json; charset=utf-8',
                    data: JSON.stringify(trip),
                    // dataType: 'json',
                });
            }

            //$("#ddg").change(function () {
            //    var selectedValue = $(this).val();
            //    //alert( selectedValue);

            //    var trip = {
            //        TripId: $(this).val()
            //    };
            //    $.ajax({
            //        type: 'POST',
            //        url: '/Home/AddLeg',
            //        cache: false,
            //        contentType: 'application/json; charset=utf-8',
            //        data: JSON.stringify(trip),
            //        // dataType: 'json',
            //    });
            //});

        </script>
    }

        <div  class="form-group" >
            <div class="col-sm-5" id="addTrip" style="float:right">
            </div>
        </div>
    
<h2>Index</h2>
    <div class="col-sm-7">
        <p>
           @* @Html.ActionLink("Create Trip","Create","Home",null, new {@class="btn btn-primary", style="margin-bottom:10px"})*@
           @Ajax.ActionLink("Create Trip","_Create","Home", new AjaxOptions { InsertionMode = InsertionMode.Replace, UpdateTargetId = "addTrip" })
               
        </p>

        <div >
            @Html.DropDownList("ddg",  (SelectList)(ViewBag.trips ), new { @class = "form-control"})
          
        </div>
    

        <p>Date: <input type="text" id="datepicker"></p>

               
        
                    <table class="table table-striped table-hover" id="tripTable">
                        <tr>
                            <th>
                                @Html.DisplayNameFor(model => model.TripName)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.StartLocation)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.FinishLocation)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.StartDate)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.FinishDate)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.MinGuests)
                            </th>
                            
                            <th></th>
                        </tr>

                    @foreach (var item in Model) {
                        <tr onclick="detsForThisTrip(@item.TripId)" >
                            <td>
                                @Html.DisplayFor(modelItem => item.TripName)
                            </td>
                            <th>
                                @Html.DisplayFor(modelItem => item.StartLocation)
                            </th>
                            <th>
                                @Html.DisplayFor(modelItem => item.FinishLocation)
                            </th>
                            <td>
                                @Html.DisplayFor(modelItem => item.StartDate)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.FinishDate)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.MinGuests)
                            </td>
                            
                            <td>
                                @*@Html.ActionLink("Add a leg", "Edit", new { id=item.TripId }) |*@
                                @Ajax.ActionLink("Add a leg", "_AddLeg", new { id = item.TripId }, new AjaxOptions { InsertionMode = InsertionMode.Replace, UpdateTargetId = "addTrip", OnSuccess="checkIfFirst" })
                            </td>
                        </tr>
                    }

                    </table>
            </div>
   